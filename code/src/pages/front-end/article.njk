{% extends "layouts/front-end/base.njk" %}
{% set bubble_color = "violet" %}

{% block main %}
  <article class="max-w-3xl mx-auto my-10 px-4 sm:px-0">

    {# Image de l'article (sans carte derrière) #}
    <figure class="mb-6">
      <img
        class="w-full h-[340px] sm:h-[420px] object-cover"
        src="{{ '/images/image-placeholder-article.png'
                if (not article.image or article.image|length == 0)
                else '/uploads/' ~ article.image }}"
        alt="{{ article.title }}"
      >
      {% if article.photo_credit %}
        <figcaption class="mt-2 text-xs text-gray-500 text-center">
          Crédit photo : {{ article.photo_credit }}
        </figcaption>
      {% endif %}
    </figure>

    {# Header texte #}
    <header class="pb-6 border-b border-gray-200">
      <h1 class="text-3xl sm:text-4xl font-extrabold leading-tight text-gray-900">
        {{ article.title }}
      </h1>

      <div class="mt-4 flex flex-wrap items-center gap-3 text-sm text-gray-600">
        <span class="italic">
          {% if article.author %}
            Par
            <a href="/author/{{ article.author._id }}" class="not-italic font-semibold text-gray-900 hover:underline underline-offset-4">
              {{ article.author.firstname }} {{ article.author.lastname }}
            </a>
          {% else %}
            La rédaction
          {% endif %}
        </span>

        {# Si tu as une date dans ton objet article, elle s’affiche #}
        {% if article.createdAt %}
          <span class="text-gray-300">•</span>
          <time datetime="{{ article.createdAt }}">{{ article.createdAt }}</time>
        {% endif %}
      </div>

      {# Chapo (abstract) #}
      {% if article.abstract %}
        <p class="mt-5 text-lg sm:text-xl leading-relaxed text-gray-800">
          {{ article.abstract }}
        </p>
      {% endif %}
    </header>

    {# Vidéo YouTube #}
    {% if article.yt_video_id %}
      <section class="mt-8">
        <div class="aspect-video">
          <iframe
            class="w-full h-full"
            src="https://www.youtube.com/embed/{{ article.yt_video_id }}"
            title="Vidéo associée à l'article"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
            referrerpolicy="strict-origin"
          ></iframe>
        </div>
      </section>
    {% endif %}

<div class="mt-8 text-base sm:text-lg leading-relaxed text-gray-900 [&_p]:mb-4">
  {{ article.content | safe }}
</div>



  </article>
{% endblock %}
